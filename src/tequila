#!/usr/bin/env php
<?php

if (!class_exists('Gallic'))
{
	require 'Gallic.php';
}
Gallic::$include_dirs[] = defined('__DIR__') ? __DIR__ : dirname(__FILE__);

////////////////////////////////////////////////////////////////////////////////

function loadConfig(array $config, Tequila $tequila)
{
	foreach (array('prompt') as $entry)
	{
		if (isset($config[$entry]))
		{
			$tequila->$entry = $tequila->parseConfigEntry($config[$entry]);
		}
	}

	if (isset($config['include_dirs']))
	{
		$tequila->class_loader = new Tequila_ClassLoader_Gallic(
			$tequila->parseConfigEntry($config['include_dirs'])
		);
	}

	if (isset($config['log_file']))
	{
		$tequila->logger = new Tequila_Logger_File(
			$tequila->parseConfigEntry($config['log_file'])
		);
	}
}

////////////////////////////////////////////////////////////////////////////////

$tequila = Tequila::create();

loadConfig(parse_ini_file('/etc/tequila/tequila.ini'), $tequila);

$tequila->start();
